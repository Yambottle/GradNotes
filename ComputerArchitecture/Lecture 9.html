<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.12 (457936)"/><meta name="altitude" content="177.3118286132812"/><meta name="author" content="chinibottle@gmail.com"/><meta name="created" content="2018-02-20 20:08:18 +0000"/><meta name="latitude" content="32.86154587238042"/><meta name="longitude" content="-96.76660200612977"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-02-20 21:37:48 +0000"/><title>Lecture 9</title></head><body><div><ol start="1"><li>5-stage pipeline=&gt; took one clock cycle</li><ol><li>IF</li><li>ID</li><li>EX</li><li>MEM</li><li>WB</li></ol><li>Ideal speedup for a n-stage pipeline is ’n’</li><li>To avoid Hazard:</li><ol><li>Read After Write: true dependency; data is actually flowing between instructions</li><li>Write After Read: anti-dependency; </li><ol><li>The reason why it doesn’t matter is ADD always reads before SUB will write in 5-stage pipeline, but that can happen in the reverse order in out of order processor</li></ol><li>Write After Write: output dependency</li></ol><li>In 5-stage pipeline, there are 2 ways to deal with RAW hazards:</li><ol><li>stall: we aren’t able to fetch the correct register value in time, so we insert NOPS/NOOPS (has all control signals set to empty set, do nothing) into the pipeline</li><ol><li>the hazard detection Hardware is in the ID stage(stall)</li><li>pipeline register store temp result, operand values…...</li><li>Hazard detection logic looks in ID/EX register, EX/MEM register or MEM/WB register and picks up the ‘write register’ and whether that instruction actually writes. It compares the read registers for the instruction in ID</li><ol><li>write on the first half, read on the second half (send the waiting register the current value) called <font color="#ff2600">register forwarding</font></li><li>use  mux to send the current value of WB </li></ol></ol><li>forwarding: </li><ol><li>If the data is currently present in the pipeline at the beginning of the clock cycle, I can use forwarding paths to send it to where I need it</li><ol><li>from MEM or WB, send data to EX</li></ol></ol></ol><li>Control Hazard:<font color="#ff2600"> when every branch, you don’t know what’s the next </font></li><ol><li>book: </li><ol><li>calculates target address in ID stage;</li><li>uses ALU to do comparison;</li><li>by end of stage when BEQ is in EX it knows if the branch should be taken</li><li>If it needs to take the branch, it fetches instruction target address when BEQ is in memory. It also flushes the instructions present in EX and ID if branch was taken</li><li>flush=&gt; cancel instruction</li></ol></ol><li>Structure Hazard: happens when I have 2 instructions that want to use the same piece of Hardware<font color="#ff2600">=&gt;how to solve: take turns or add one HW</font></li><li>Precise exceptions int he 5 stage pipeline</li><ol><li>you want the instruction that triggered the exception and all instructions that come after it in program order to be flushed from the pipeline. And you want the instructions that preceded this instruction to finish. </li><li>After all this happens the exception handler can start : using ’silent’ exceptions</li><ol><li>different instructions can cause exceptions at the same time and in different stage</li><li>set ESR(exception status register) when you see an exception</li><li>you NOP that instruction and the ones that come later</li><li>you wait until the instruction that caused the exception is in write back and then you take the exception because you know the preceding instructions finished successfully</li></ol></ol><li>Alternative pipeline</li><ol><li>Floating Point instructions take longer in EX</li><ol><li>longer pipeline=&gt; wait longer</li><li>two pipelines</li></ol></ol></ol></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>